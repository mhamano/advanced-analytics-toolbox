{"version":3,"sources":["chart/line_chart.js"],"names":["define","Plotly","utils","draw","$scope","data","elementId","customOptions","options","showlegend","layout","props","showLegend","xaxis","title","xLabelsAndTitle","dimensions","label","showgrid","xScale","side","xAxisPosition","type","xAxisType","yaxis","yLabelsAndTitle","measures","yScale","yAxisPosition","tickformat","getTickFormat","tickprefix","getPrefix","ticksuffix","getSuffix","separators","getSeparators","dragmode","margin","r","marginRight","l","marginLeft","t","marginTop","b","marginBottom","$","extend","config","scrollZoom","showLink","displaylogo","modeBarButtonsToRemove","chart","document","getElementById","plot","setEvents","app","on","eventData","points","length","pointNumber","elemNum","fields","parseInt","self","selectValues","filter","d","map","backendApi"],"mappings":"AAAA,YAAAA,SACE,0BACA,iBACC,SAACC,EAAQC,GACV,OAWEC,KAXK,SAWAC,EAAQC,EAAMC,EAAWC,GAC5B,GAAMC,IACJC,WAAYL,EAAOM,OAAOC,MAAMC,WAChCC,OACEC,MAAOV,EAAOM,OAAOC,MAAMI,gBAAkBX,EAAOM,OAAOC,MAAMK,WAAW,GAAGC,MAAQ,GACvFC,SAAUd,EAAOM,OAAOC,MAAMQ,OAC9BC,KAAMhB,EAAOM,OAAOC,MAAMU,cAC1BC,KAAMlB,EAAOM,OAAOC,MAAMY,WAE5BC,OACEV,MAAOV,EAAOM,OAAOC,MAAMc,gBAAkBrB,EAAOM,OAAOC,MAAMe,SAAS,GAAGT,MAAQ,GACrFC,SAAUd,EAAOM,OAAOC,MAAMgB,OAC9BP,KAAMhB,EAAOM,OAAOC,MAAMiB,cAC1BC,WAAY3B,EAAM4B,cAAc1B,EAAQ,GACxC2B,WAAY7B,EAAM8B,UAAU5B,EAAQ,GACpC6B,WAAY/B,EAAMgC,UAAU9B,EAAQ,IAEtC+B,WAAYjC,EAAMkC,cAAchC,EAAQ,GACxCiC,SAAU,SACVC,QACEC,EAAyC,SAArCnC,EAAOM,OAAOC,MAAMiB,cAA4BxB,EAAOM,OAAOC,MAAM6B,YAAc,GAAKpC,EAAOM,OAAOC,MAAM6B,YAC/GC,EAAyC,QAArCrC,EAAOM,OAAOC,MAAMiB,cAA2BxB,EAAOM,OAAOC,MAAM+B,WAAa,GAAKtC,EAAOM,OAAOC,MAAM+B,WAC7GC,EAAyC,OAArCvC,EAAOM,OAAOC,MAAMU,cAA0BjB,EAAOM,OAAOC,MAAMiC,UAAY,GAAKxC,EAAOM,OAAOC,MAAMiC,UAC3GC,EAAyC,UAArCzC,EAAOM,OAAOC,MAAMU,cAA6BjB,EAAOM,OAAOC,MAAMmC,aAAe,GAAK1C,EAAOM,OAAOC,MAAMmC,cAIrHC,GAAEC,OAAOxC,EAASD,EAElB,IAAM0C,IACJC,YAAY,EACZC,UAAU,EACVC,aAAa,EACbC,wBAAyB,oBAGrBC,EAAQC,SAASC,eAAelD,EAGtC,OAFAL,GAAOwD,KAAKH,EAAOjD,EAAMG,EAASyC,GAE3BK,GAUTI,UA5DK,SA4DKJ,EAAOlD,EAAQuD,GAuBvB,MAtBAL,GAAMM,GAAG,eAAgB,SAACC,GACxB,GAAwB,mBAAbA,IAA4BA,EAAUC,OAAOC,OAAS,EAAG,CAClE,GAAMC,GAAcH,EAAUC,OAAO,GAAGE,WACxC,IAA+C,mBAApCH,GAAUC,OAAO,GAAGzD,KAAK4D,QAAwB,CAC1D,GAAMC,IAAUC,SAASN,EAAUC,OAAO,GAAGzD,KAAK4D,QAAQD,GAAc,IACxE5D,GAAOgE,KAAKC,aAAa,EAAGH,GAAQ,OAK1CZ,EAAMM,GAAG,kBAAmB,SAACC,GAC3B,GAAwB,mBAAbA,IAA4BA,EAAUC,OAAOC,OAAS,EAAG,CAClE,GAAMG,GAASL,EAAUC,OAAOQ,OAAO,SAACC,GAEtC,MAAiE,mBAAnDV,GAAUC,OAAO,GAAGzD,KAAK4D,QAAQM,EAAEP,eAChDQ,IAAI,SAACD,GACN,MAAOJ,UAASN,EAAUC,OAAO,GAAGzD,KAAK4D,QAAQM,EAAEP,aAAc,KAEnE5D,GAAOqE,WAAWJ,aAAa,EAAGH,GAAQ,MAIvC","file":"../../js/chart/line_chart.js","sourcesContent":["define([\r\n  '../../vendor/plotly.min',\r\n  '../util/utils'\r\n], (Plotly, utils) => {\r\n  return {\r\n    /**\r\n     * draw - draw chart\r\n     *\r\n     * @param {Object} $scope        angular $scope\r\n     * @param {Object} data          Data for chart\r\n     * @param {String} elementId     HTML element id to embed chart\r\n     * @param {Object} customOptions Custom chart options\r\n     *\r\n     * @return {Object} Chart object\r\n     */\r\n    draw($scope, data, elementId, customOptions) {\r\n      const options = {\r\n        showlegend: $scope.layout.props.showLegend,\r\n        xaxis: {\r\n          title: $scope.layout.props.xLabelsAndTitle ? $scope.layout.props.dimensions[0].label : '',\r\n          showgrid: $scope.layout.props.xScale,\r\n          side: $scope.layout.props.xAxisPosition,\r\n          type: $scope.layout.props.xAxisType,\r\n        },\r\n        yaxis: {\r\n          title: $scope.layout.props.yLabelsAndTitle ? $scope.layout.props.measures[0].label : '',\r\n          showgrid: $scope.layout.props.yScale,\r\n          side: $scope.layout.props.yAxisPosition,\r\n          tickformat: utils.getTickFormat($scope, 0),\r\n          tickprefix: utils.getPrefix($scope, 0),\r\n          ticksuffix: utils.getSuffix($scope, 0),\r\n        },\r\n        separators: utils.getSeparators($scope, 0),\r\n        dragmode: 'select',\r\n        margin: {\r\n          r: ($scope.layout.props.yAxisPosition == 'right') ? $scope.layout.props.marginRight + 70 : $scope.layout.props.marginRight,\r\n          l: ($scope.layout.props.yAxisPosition == 'left') ? $scope.layout.props.marginLeft + 70 : $scope.layout.props.marginLeft,\r\n          t: ($scope.layout.props.xAxisPosition == 'top') ? $scope.layout.props.marginTop + 70 : $scope.layout.props.marginTop,\r\n          b: ($scope.layout.props.xAxisPosition == 'bottom') ? $scope.layout.props.marginBottom + 70 : $scope.layout.props.marginBottom,\r\n        },\r\n      };\r\n\r\n      $.extend(options, customOptions);\r\n\r\n      const config = {\r\n        scrollZoom: true,\r\n        showLink: false,\r\n        displaylogo: false,\r\n        modeBarButtonsToRemove: ['sendDataToCloud'],\r\n      };\r\n\r\n      const chart = document.getElementById(elementId);\r\n      Plotly.plot(chart, data, options, config);\r\n\r\n      return chart;\r\n    },\r\n\r\n    /**\r\n     * setEvents - set events to the chart\r\n     *\r\n     * @param {type} chart Description\r\n     *\r\n     * @return {type} Description\r\n     */\r\n    setEvents(chart, $scope, app) {\r\n      chart.on('plotly_click', (eventData) => {\r\n        if (typeof eventData != 'undefined' && eventData.points.length > 0) {\r\n          const pointNumber = eventData.points[0].pointNumber;\r\n          if (typeof eventData.points[0].data.elemNum != 'undefined') {\r\n            const fields = [parseInt(eventData.points[0].data.elemNum[pointNumber], 10)];\r\n            $scope.self.selectValues(0, fields, true);\r\n          }\r\n        }\r\n      });\r\n\r\n      chart.on('plotly_selected', (eventData) => {\r\n        if (typeof eventData != 'undefined' && eventData.points.length > 0) {\r\n          const fields = eventData.points.filter((d) => {\r\n            // return true when not NaN\r\n            return typeof eventData.points[0].data.elemNum[d.pointNumber] != 'undefined';\r\n          }).map((d) => {\r\n            return parseInt(eventData.points[0].data.elemNum[d.pointNumber], 10);\r\n          });\r\n          $scope.backendApi.selectValues(0, fields, true);\r\n        }\r\n      });\r\n\r\n      return null;\r\n    },\r\n  };\r\n});\r\n"]}